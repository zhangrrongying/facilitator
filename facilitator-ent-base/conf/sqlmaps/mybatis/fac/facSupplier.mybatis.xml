<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guzz-configs PUBLIC "-//GUZZ//DTD MAIN CONFIG//EN" "http://www.guzz.org/dtd/guzz.dtd">
<guzz-configs>
	<sqlMap dbgroup="facMysql">
		
		<select id="queryBkdSupplierSize" orm="facSupplier" templated="true">
			<![CDATA[
			SELECT COUNT(*) FROM fac_supplier a 
			WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND a.`Name` LIKE concat('%',:name,'%') 
		    #end
			]]>
		</select>
		
		<select id="queryBkdSuppliers" orm="facSupplier" templated="true">
			<![CDATA[
			SELECT a.* FROM fac_supplier a 
			WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND a.`Name` LIKE concat('%',:name,'%') 
		    #end
			ORDER BY a.Create_Time DESC LIMIT :offset,:limit
			]]>
		</select>
		
		<select id="queryBkdProjectSize" orm="facProject" templated="true">
			<![CDATA[
			SELECT COUNT(*) FROM fac_project a 
			WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND a.`Name` LIKE concat('%',:name,'%') 
		    #end
		    
		    #if($projectTypeId > 0)
	          AND a.Project_Type_Id = :projectTypeId 
	        #end
			]]>
		</select>
		
		<select id="queryBkdProjects" orm="facProject" templated="true">
			<![CDATA[
			SELECT a.*,b.`Name` AS projectTypeName,c.`Name` AS createUserName FROM fac_project a LEFT JOIN 
			fac_project_type b ON a.Project_Type_Id = b.Id LEFT JOIN sys_user c ON a.Create_User = c.Id
			WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND a.`Name` LIKE concat('%',:name,'%') 
		    #end
		    
		    #if($projectTypeId > 0)
	          AND a.Project_Type_Id = :projectTypeId 
	        #end
			ORDER BY a.Create_Time DESC LIMIT :offset,:limit
			]]>
		</select>
		
		<select id="queryBkdProjectBidSize" orm="facProject" templated="true">
			<![CDATA[
			SELECT COUNT(*) FROM fac_supplier_project_relative a LEFT JOIN fac_supplier b ON a.Supplier_Id = b.Id 
			LEFT JOIN fac_project c ON a.Project_Id = c.Id  WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND c.`Name` LIKE concat('%',:name,'%') 
		    #end
		    
		    #notEmpty($supplierName)
		      AND b.`Name` LIKE concat('%',:supplierName,'%') 
		    #end
		    
		    #if($projectTypeId > 0)
	          AND c.Project_Type_Id = :projectTypeId 
	        #end
			]]>
		</select>
		
		<select id="queryBkdProjectBids" orm="facProject" templated="true">
			<![CDATA[
			SELECT a.Id,b.`Name` AS supplierName,c.`Name`,c.Investment,a.Bid_Time AS createTime,c.Status,d.`Name` AS projectTypeName 
			FROM fac_supplier_project_relative a LEFT JOIN fac_supplier b ON a.Supplier_Id = b.Id LEFT JOIN 
			fac_project c ON a.Project_Id = c.Id LEFT JOIN fac_project_type d ON c.Project_Type_Id = d.Id WHERE 1 = 1 
		    
		    #notEmpty($name)
		      AND c.`Name` LIKE concat('%',:name,'%') 
		    #end
		    
		    #notEmpty($supplierName)
		      AND b.`Name` LIKE concat('%',:supplierName,'%') 
		    #end
		    
		    #if($projectTypeId > 0)
	          AND c.Project_Type_Id = :projectTypeId 
	        #end
	        ORDER BY a.Bid_Time DESC LIMIT :offset,:limit
			]]>
		</select>
		
		<select id="getProjectBids" orm="facProject" templated="true">
			<![CDATA[
			SELECT a.* FROM fac_project a WHERE NOT EXISTS (SELECT b.Project_Id FROM fac_supplier_project_relative b 
			WHERE a.Id = b.Project_Id)
			]]>
		</select>
		
		<select id="getBidProjectListByUserId" orm="facProject" templated="true">
			<![CDATA[
			SELECT b.* FROM fac_supplier_project_relative a LEFT JOIN fac_project b ON b.Id = a.Project_Id 
			LEFT JOIN fac_supplier c ON a.Supplier_Id = c.Id WHERE c.Create_User = :userId
			]]>
		</select>
  	</sqlMap>
 </guzz-configs>